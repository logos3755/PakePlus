import{_ as Oe}from"./delete-bin6-line.BKYKD4Vo.js";import{a as Re,_ as Te}from"./search-line.CPsQ9K27.js";import{O as Pe,F as x,bb as de,H as E,bc as ue,J as K,Q as J,d as ae,K as ce,r as w,P as re,c as N,bd as Ee,b6 as G,T as pe,o as Q,be as Me,e as Le,a6 as X,g as U,bf as je,G as Fe,I as W,bg as Be,bh as Ae,_ as Y,a4 as He,i as Ve,v as O,x as A,A as e,B as a,C as $,z as k,aa as se,ab as H,a8 as le,a3 as q,y as j,a7 as L,a9 as me,ad as Ne}from"./entry.B79t8160.js";import{i as qe,d as We,g as Ge,B as Z,_ as fe}from"./Button.DLsEGMw6.js";import{t as Ke,N as be}from"./Tag.ehYFDh3x.js";import{_ as _e}from"./Space.CoyloG0X.js";import{_ as Je}from"./Pagination.oy2G0JHk.js";import{_ as Qe,a as Xe}from"./tree.B3YHNUVY.js";import{_ as Ye}from"./Ellipsis.CqrBrMIw.js";import{r as Ze,b as et,f as tt}from"./use-merged-state.Dyf7G0SV.js";import{u as nt}from"./use-compitable.BTv5PzVL.js";import{_ as at}from"./Spin.BLjgZzmt.js";import{_ as oe}from"./Card.t-T5tsO1.js";import{_ as lt,S as ot}from"./Scrollbar.DfppsR0A.js";import{_ as rt}from"./loading.DIF8ReVX.js";import{_ as ve,a as ge}from"./FormItem.C3DR4S6Q.js";import{_ as st}from"./Select.DOm-zoi7.js";import{_ as it}from"./Tree.cVHN8enr.js";import{u as dt}from"./use-message.BH-wgOTP.js";import{_ as ut,a as ct}from"./Grid.DwqS4h9-.js";import{_ as pt,a as mt}from"./Tabs.CgZEd0ml.js";import{_ as ft}from"./Layout.BrvNxXSP.js";import{_ as bt}from"./Modal.CeSbMG6K.js";import"./Popover.rmCVgHdz.js";import"./Tooltip.LN34_rQh.js";import"./iconify.BCVX6Ifv.js";import"./index.DxLfcg4e.js";import"./Empty.Dpu5cBr_.js";import"./Checkbox.BnzM6f0E.js";function ie(t,f="default",c=[]){const{children:b}=t;if(b!==null&&typeof b=="object"&&!Array.isArray(b)){const m=b[f];if(typeof m=="function")return m()}return c}const _t=qe&&"loading"in document.createElement("img");function vt(t={}){var f;const{root:c=null}=t;return{hash:`${t.rootMargin||"0px 0px 0px 0px"}-${Array.isArray(t.threshold)?t.threshold.join(","):(f=t.threshold)!==null&&f!==void 0?f:"0"}`,options:Object.assign(Object.assign({},t),{root:(typeof c=="string"?document.querySelector(c):c)||document.documentElement})}}const ee=new WeakMap,te=new WeakMap,ne=new WeakMap,gt=(t,f,c)=>{if(!t)return()=>{};const b=vt(f),{root:m}=b.options;let r;const l=ee.get(m);l?r=l:(r=new Map,ee.set(m,r));let p,o;r.has(b.hash)?(o=r.get(b.hash),o[1].has(t)||(p=o[0],o[1].add(t),p.observe(t))):(p=new IntersectionObserver(_=>{_.forEach(h=>{if(h.isIntersecting){const s=te.get(h.target),v=ne.get(h.target);s&&s(),v&&(v.value=!0)}})},b.options),p.observe(t),o=[p,new Set([t])],r.set(b.hash,o));let S=!1;const I=()=>{S||(te.delete(t),ne.delete(t),S=!0,o[1].has(t)&&(o[0].unobserve(t),o[1].delete(t)),o[1].size<=0&&r.delete(b.hash),r.size||ee.delete(m))};return te.set(t,I),ne.set(t,c),I},ht=Pe("n-avatar-group"),yt=x("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[de(E("&","--n-merged-color: var(--n-color-modal);")),ue(E("&","--n-merged-color: var(--n-color-popover);")),E("img",`
 width: 100%;
 height: 100%;
 `),K("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),x("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),K("text","line-height: 1.25")]),xt=Object.assign(Object.assign({},J.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),zt=ae({name:"Avatar",props:xt,setup(t){const{mergedClsPrefixRef:f,inlineThemeDisabled:c}=ce(t),b=w(!1);let m=null;const r=w(null),l=w(null),p=()=>{const{value:n}=r;if(n&&(m===null||m!==n.innerHTML)){m=n.innerHTML;const{value:d}=l;if(d){const{offsetWidth:z,offsetHeight:g}=d,{offsetWidth:i,offsetHeight:T}=n,y=.9,R=Math.min(z/i*y,g/T*y,1);n.style.transform=`translateX(-50%) translateY(-50%) scale(${R})`}}},o=re(ht,null),S=N(()=>{const{size:n}=t;if(n)return n;const{size:d}=o||{};return d||"medium"}),I=J("Avatar","-avatar",yt,Ee,t,f),_=re(Ke,null),h=N(()=>{if(o)return!0;const{round:n,circle:d}=t;return n!==void 0||d!==void 0?n||d:_?_.roundRef.value:!1}),s=N(()=>o?!0:t.bordered||!1),v=N(()=>{const n=S.value,d=h.value,z=s.value,{color:g}=t,{self:{borderRadius:i,fontSize:T,color:y,border:R,colorModal:M,colorPopover:V},common:{cubicBezierEaseInOut:F}}=I.value;let B;return typeof n=="number"?B=`${n}px`:B=I.value.self[G("height",n)],{"--n-font-size":T,"--n-border":z?R:"none","--n-border-radius":d?"50%":i,"--n-color":g||y,"--n-color-modal":g||M,"--n-color-popover":g||V,"--n-bezier":F,"--n-merged-size":`var(--n-avatar-size-override, ${B})`}}),u=c?pe("avatar",N(()=>{const n=S.value,d=h.value,z=s.value,{color:g}=t;let i="";return n&&(typeof n=="number"?i+=`a${n}`:i+=n[0]),d&&(i+="b"),z&&(i+="c"),g&&(i+=We(g)),i}),v,t):void 0,C=w(!t.lazy);Q(()=>{if(t.lazy&&t.intersectionObserverOptions){let n;const d=Me(()=>{n==null||n(),n=void 0,t.lazy&&(n=gt(l.value,t.intersectionObserverOptions,C))});Le(()=>{d(),n==null||n()})}}),X(()=>{var n;return t.src||((n=t.imgProps)===null||n===void 0?void 0:n.src)},()=>{b.value=!1});const D=w(!t.lazy);return{textRef:r,selfRef:l,mergedRoundRef:h,mergedClsPrefix:f,fitTextTransform:p,cssVars:c?void 0:v,themeClass:u==null?void 0:u.themeClass,onRender:u==null?void 0:u.onRender,hasLoadError:b,shouldStartLoading:C,loaded:D,mergedOnError:n=>{if(!C.value)return;b.value=!0;const{onError:d,imgProps:{onError:z}={}}=t;d==null||d(n),z==null||z(n)},mergedOnLoad:n=>{const{onLoad:d,imgProps:{onLoad:z}={}}=t;d==null||d(n),z==null||z(n),D.value=!0}}},render(){var t,f;const{$slots:c,src:b,mergedClsPrefix:m,lazy:r,onRender:l,loaded:p,hasLoadError:o,imgProps:S={}}=this;l==null||l();let I;const _=!p&&!o&&(this.renderPlaceholder?this.renderPlaceholder():(f=(t=this.$slots).placeholder)===null||f===void 0?void 0:f.call(t));return this.hasLoadError?I=this.renderFallback?this.renderFallback():Ze(c.fallback,()=>[U("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):I=et(c.default,h=>{if(h)return U(je,{onResize:this.fitTextTransform},{default:()=>U("span",{ref:"textRef",class:`${m}-avatar__text`},h)});if(b||S.src){const s=this.src||S.src;return U("img",Object.assign(Object.assign({},S),{loading:_t&&!this.intersectionObserverOptions&&r?"lazy":"eager",src:r&&this.intersectionObserverOptions?this.shouldStartLoading?s:void 0:s,"data-image-src":s,onLoad:this.mergedOnLoad,onError:this.mergedOnError,style:[S.style||"",{objectFit:this.objectFit},_?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),U("span",{ref:"selfRef",class:[`${m}-avatar`,this.themeClass],style:this.cssVars},I,r&&_)}}),he="DESCRIPTION_ITEM_FLAG";function wt(t){return typeof t=="object"&&t&&!Array.isArray(t)?t.type&&t.type[he]:!1}const St=E([x("descriptions",{fontSize:"var(--n-font-size)"},[x("descriptions-separator",`
 display: inline-block;
 margin: 0 8px 0 2px;
 `),x("descriptions-table-wrapper",[x("descriptions-table",[x("descriptions-table-row",[x("descriptions-table-header",{padding:"var(--n-th-padding)"}),x("descriptions-table-content",{padding:"var(--n-td-padding)"})])])]),Fe("bordered",[x("descriptions-table-wrapper",[x("descriptions-table",[x("descriptions-table-row",[E("&:last-child",[x("descriptions-table-content",{paddingBottom:0})])])])])]),W("left-label-placement",[x("descriptions-table-content",[E("> *",{verticalAlign:"top"})])]),W("left-label-align",[E("th",{textAlign:"left"})]),W("center-label-align",[E("th",{textAlign:"center"})]),W("right-label-align",[E("th",{textAlign:"right"})]),W("bordered",[x("descriptions-table-wrapper",`
 border-radius: var(--n-border-radius);
 overflow: hidden;
 background: var(--n-merged-td-color);
 border: 1px solid var(--n-merged-border-color);
 `,[x("descriptions-table",[x("descriptions-table-row",[E("&:not(:last-child)",[x("descriptions-table-content",{borderBottom:"1px solid var(--n-merged-border-color)"}),x("descriptions-table-header",{borderBottom:"1px solid var(--n-merged-border-color)"})]),x("descriptions-table-header",`
 font-weight: 400;
 background-clip: padding-box;
 background-color: var(--n-merged-th-color);
 `,[E("&:not(:last-child)",{borderRight:"1px solid var(--n-merged-border-color)"})]),x("descriptions-table-content",[E("&:not(:last-child)",{borderRight:"1px solid var(--n-merged-border-color)"})])])])])]),x("descriptions-header",`
 font-weight: var(--n-th-font-weight);
 font-size: 18px;
 transition: color .3s var(--n-bezier);
 line-height: var(--n-line-height);
 margin-bottom: 16px;
 color: var(--n-title-text-color);
 `),x("descriptions-table-wrapper",`
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[x("descriptions-table",`
 width: 100%;
 border-collapse: separate;
 border-spacing: 0;
 box-sizing: border-box;
 `,[x("descriptions-table-row",`
 box-sizing: border-box;
 transition: border-color .3s var(--n-bezier);
 `,[x("descriptions-table-header",`
 font-weight: var(--n-th-font-weight);
 line-height: var(--n-line-height);
 display: table-cell;
 box-sizing: border-box;
 color: var(--n-th-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),x("descriptions-table-content",`
 vertical-align: top;
 line-height: var(--n-line-height);
 display: table-cell;
 box-sizing: border-box;
 color: var(--n-td-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[K("content",`
 transition: color .3s var(--n-bezier);
 display: inline-block;
 color: var(--n-td-text-color);
 `)]),K("label",`
 font-weight: var(--n-th-font-weight);
 transition: color .3s var(--n-bezier);
 display: inline-block;
 margin-right: 14px;
 color: var(--n-th-text-color);
 `)])])])]),x("descriptions-table-wrapper",`
 --n-merged-th-color: var(--n-th-color);
 --n-merged-td-color: var(--n-td-color);
 --n-merged-border-color: var(--n-border-color);
 `),de(x("descriptions-table-wrapper",`
 --n-merged-th-color: var(--n-th-color-modal);
 --n-merged-td-color: var(--n-td-color-modal);
 --n-merged-border-color: var(--n-border-color-modal);
 `)),ue(x("descriptions-table-wrapper",`
 --n-merged-th-color: var(--n-th-color-popover);
 --n-merged-td-color: var(--n-td-color-popover);
 --n-merged-border-color: var(--n-border-color-popover);
 `))]),Ct=Object.assign(Object.assign({},J.props),{title:String,column:{type:Number,default:3},columns:Number,labelPlacement:{type:String,default:"top"},labelAlign:{type:String,default:"left"},separator:{type:String,default:":"},size:{type:String,default:"medium"},bordered:Boolean,labelClass:String,labelStyle:[Object,String],contentClass:String,contentStyle:[Object,String]}),$t=ae({name:"Descriptions",props:Ct,setup(t){const{mergedClsPrefixRef:f,inlineThemeDisabled:c}=ce(t),b=J("Descriptions","-descriptions",St,Be,t,f),m=N(()=>{const{size:l,bordered:p}=t,{common:{cubicBezierEaseInOut:o},self:{titleTextColor:S,thColor:I,thColorModal:_,thColorPopover:h,thTextColor:s,thFontWeight:v,tdTextColor:u,tdColor:C,tdColorModal:D,tdColorPopover:n,borderColor:d,borderColorModal:z,borderColorPopover:g,borderRadius:i,lineHeight:T,[G("fontSize",l)]:y,[G(p?"thPaddingBordered":"thPadding",l)]:R,[G(p?"tdPaddingBordered":"tdPadding",l)]:M}}=b.value;return{"--n-title-text-color":S,"--n-th-padding":R,"--n-td-padding":M,"--n-font-size":y,"--n-bezier":o,"--n-th-font-weight":v,"--n-line-height":T,"--n-th-text-color":s,"--n-td-text-color":u,"--n-th-color":I,"--n-th-color-modal":_,"--n-th-color-popover":h,"--n-td-color":C,"--n-td-color-modal":D,"--n-td-color-popover":n,"--n-border-radius":i,"--n-border-color":d,"--n-border-color-modal":z,"--n-border-color-popover":g}}),r=c?pe("descriptions",N(()=>{let l="";const{size:p,bordered:o}=t;return o&&(l+="a"),l+=p[0],l}),m,t):void 0;return{mergedClsPrefix:f,cssVars:c?void 0:m,themeClass:r==null?void 0:r.themeClass,onRender:r==null?void 0:r.onRender,compitableColumn:nt(t,["columns","column"]),inlineThemeDisabled:c}},render(){const t=this.$slots.default,f=t?tt(t()):[];f.length;const{contentClass:c,labelClass:b,compitableColumn:m,labelPlacement:r,labelAlign:l,size:p,bordered:o,title:S,cssVars:I,mergedClsPrefix:_,separator:h,onRender:s}=this;s==null||s();const v=f.filter(n=>wt(n)),u={span:0,row:[],secondRow:[],rows:[]},D=v.reduce((n,d,z)=>{const g=d.props||{},i=v.length-1===z,T=["label"in g?g.label:ie(d,"label")],y=[ie(d)],R=g.span||1,M=n.span;n.span+=R;const V=g.labelStyle||g["label-style"]||this.labelStyle,F=g.contentStyle||g["content-style"]||this.contentStyle;if(r==="left")o?n.row.push(U("th",{class:[`${_}-descriptions-table-header`,b],colspan:1,style:V},T),U("td",{class:[`${_}-descriptions-table-content`,c],colspan:i?(m-M)*2+1:R*2-1,style:F},y)):n.row.push(U("td",{class:`${_}-descriptions-table-content`,colspan:i?(m-M)*2:R*2},U("span",{class:[`${_}-descriptions-table-content__label`,b],style:V},[...T,h&&U("span",{class:`${_}-descriptions-separator`},h)]),U("span",{class:[`${_}-descriptions-table-content__content`,c],style:F},y)));else{const B=i?(m-M)*2:R*2;n.row.push(U("th",{class:[`${_}-descriptions-table-header`,b],colspan:B,style:V},T)),n.secondRow.push(U("td",{class:[`${_}-descriptions-table-content`,c],colspan:B,style:F},y))}return(n.span>=m||i)&&(n.span=0,n.row.length&&(n.rows.push(n.row),n.row=[]),r!=="left"&&n.secondRow.length&&(n.rows.push(n.secondRow),n.secondRow=[])),n},u).rows.map(n=>U("tr",{class:`${_}-descriptions-table-row`},n));return U("div",{style:I,class:[`${_}-descriptions`,this.themeClass,`${_}-descriptions--${r}-label-placement`,`${_}-descriptions--${l}-label-align`,`${_}-descriptions--${p}-size`,o&&`${_}-descriptions--bordered`]},S||this.$slots.header?U("div",{class:`${_}-descriptions-header`},S||Ge(this,"header")):null,U("div",{class:`${_}-descriptions-table-wrapper`},U("table",{class:`${_}-descriptions-table`},U("tbody",null,r==="top"&&U("tr",{class:`${_}-descriptions-table-row`,style:{visibility:"collapse"}},Ae(m*2,U("td",null))),D))))}}),It={label:String,span:{type:Number,default:1},labelClass:String,labelStyle:[Object,String],contentClass:String,contentStyle:[Object,String]},Ut=ae({name:"DescriptionsItem",[he]:!0,props:It,render(){return null}}),Dt={key:0,class:"operation-wrapper"},kt={__name:"table",props:{depIDs:Array,maxHeight:{type:Number,default:0}},emits:["editUser","delete","getUser"],setup(t,{emit:f}){const c=t,b=w(!0),m=f,r=w(!1),l=w([{text:"账号",value:"User_ID"},{text:"用户姓名",value:"username"},{text:"部门",value:"department"},{text:"职位",value:"position"},{text:"手机",value:"mobile"},{text:"性别",value:"gender"},{text:"邮箱",value:"email"},{text:"状态",value:"status",sortable:!0},{text:"操作",value:"operation"}]),p=w([]),o=He({page:1,pageCount:1,pageSize:10,pageSizes:[{label:"10条/页",value:10},{label:"20条/页",value:20},{label:"30条/页",value:30},{label:"40条/页",value:40}],itemCounts:0}),S=async()=>{try{r.value=!0;const u={page:o.page,pageSize:o.pageSize};c.depIDs&&c.depIDs.length>0&&(u.depIDs=c.depIDs);const{data:C}=await q.get("/user/list",u),{status:D,res:n}=C.value;n&&D==200?(p.value=n.items,o.itemCounts=n.total||0,o.pageCount=Math.ceil(o.itemCounts/o.pageSize)):(p.value=[],o.pageCount=1,o.itemCounts=0)}catch{p.value=[]}finally{r.value=!1}},I=u=>{o.page=u,S()},_=u=>{o.pageSize=u,o.page=1,S()},h=u=>{m("getUser",u)},s=u=>{m("editUser",u)},v=u=>{m("delete",u)};return X(()=>c.depIDs,()=>{o.page=1,S()},{deep:!0}),Q(()=>{S()}),(u,C)=>{const D=be,n=Re,d=Z,z=Oe,g=Ve("EasyDataTable"),i=_e,T=Je;return O(),A(le,null,[e(i,{vertical:"",size:12,class:"user-datatable"},{default:a(()=>[e(g,{headers:l.value,items:p.value,alternating:"","fixed-header":"","table-height":t.maxHeight-98,"table-class-name":"user-table",onClickRow:h,"hide-footer":!0},{"item-gender":a(({gender:y})=>[e(D,{type:"info",bordered:!1},{default:a(()=>[$(k(y==="1"?"男":y==="2"?"女":"未知"),1)]),_:2},1024)]),"item-status":a(({status:y})=>[e(D,{type:y==="1"?"success":"error",bordered:!1},{default:a(()=>[$(k(y==="1"?"启用":"禁用"),1)]),_:2},1032,["type"])]),"item-operation":a(y=>[b.value?(O(),A("div",Dt,[e(d,{tertiary:"",size:"tiny",onClick:se(R=>s(y),["stop"])},{default:a(()=>[e(n)]),_:2},1032,["onClick"]),e(d,{tertiary:"",size:"tiny",onClick:se(R=>v(y),["stop"])},{default:a(()=>[e(z)]),_:2},1032,["onClick"])])):H("",!0)]),_:1},8,["headers","items","table-height"])]),_:1}),e(i,{class:"user-pagination"},{default:a(()=>[e(T,{page:o.page,"onUpdate:page":C[0]||(C[0]=y=>o.page=y),"page-size":o.pageSize,"onUpdate:pageSize":C[1]||(C[1]=y=>o.pageSize=y),"page-count":o.pageCount,"show-size-picker":"","page-sizes":o.pageSizes,"on-update:page":I,"on-update:page-size":_},null,8,["page","page-size","page-count","page-sizes"])]),_:1})],64)}}},Ot=Y(kt,[["__scopeId","data-v-c4700f22"]]),Rt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Tt(t,f){return O(),A("svg",Rt,f[0]||(f[0]=[j("path",{fill:"currentColor",d:"M12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12S6.48 2 12 2M6.023 15.416C7.491 17.606 9.695 19 12.16 19c2.464 0 4.669-1.393 6.136-3.584A8.968 8.968 0 0 0 12.16 13a8.968 8.968 0 0 0-6.137 2.416M12 11a3 3 0 1 0 0-6a3 3 0 0 0 0 6"},null,-1)]))}const Pt={name:"ri-account-circle-fill",render:Tt},Et={class:"flex gap-2"},Mt={class:"mb-0"},Lt={class:"p-1 flex flex-wrap"},jt={class:"flex flex-wrap gap-[5px]"},Ft={class:"p-1 flex flex-wrap"},Bt={key:1,class:"user-empty"},At={__name:"detail",props:{user:{type:Object}},setup(t){const f=t,c=w(null),b=w(!1);return X(()=>f.user,async m=>{if(m&&m.User_ID){b.value=!0;try{const{data:r}=await q.get(`/user/${m.id}`),{status:l,res:p}=r.value;l===200&&p?c.value=p:c.value=null}catch{c.value=null}finally{b.value=!1}}else c.value=null},{immediate:!0}),(m,r)=>{const l=Pt,p=be,o=Ut,S=Ye,I=zt,_=$t,h=at,s=oe,v=Qe,u=Z,C=lt;return t.user?(O(),L(s,{key:0},{default:a(()=>[e(h,{show:b.value},{default:a(()=>[e(_,{"label-placement":"top",size:"small",bordered:"",column:2,"label-class":"user-detail-label","content-class":"user-detail-content"},{default:a(()=>[e(o,{label:"账号信息",span:2},{default:a(()=>[j("div",Et,[e(l,{class:"text-[60px]"}),j("div",null,[j("p",Mt,k(t.user.User_ID),1),e(p,{bordered:!1,type:t.user.status==="1"?"success":"error"},{default:a(()=>[$(k(t.user.status==="1"?"启用":"禁用"),1)]),_:1},8,["type"])])])]),_:1}),e(o,{label:"钉钉ID"},{default:a(()=>[$(k(t.user.Ding_ID||"暂无"),1)]),_:1}),e(o,{label:"微信ID"},{default:a(()=>[$(k(t.user.openid||"暂无"),1)]),_:1}),e(o,{label:"用户姓名"},{default:a(()=>[$(k(t.user.username),1)]),_:1}),e(o,{label:"部门"},{default:a(()=>[$(k(t.user.department),1)]),_:1}),e(o,{label:"主部门"},{default:a(()=>[$(k(t.user.main_department||"暂无"),1)]),_:1}),e(o,{label:"位置"},{default:a(()=>[$(k(t.user.position),1)]),_:1}),e(o,{label:"手机"},{default:a(()=>[e(S,null,{default:a(()=>[$(k(t.user.mobile),1)]),_:1})]),_:1}),e(o,{label:"性别"},{default:a(()=>[e(p,{type:"info",bordered:!1},{default:a(()=>[$(k(t.user.gender==="1"?"男":t.user.gender==="2"?"女":"未知"),1)]),_:1})]),_:1}),e(o,{label:"邮箱",span:2},{default:a(()=>[$(k(t.user.email),1)]),_:1}),t.user.avatar?(O(),L(o,{key:0,label:"头像"},{default:a(()=>[e(I,{size:"small",src:t.user.avatar},null,8,["src"])]),_:1})):H("",!0),e(o,{label:"状态"},{default:a(()=>[e(p,{bordered:!1,type:t.user.status==="1"?"success":"error"},{default:a(()=>[$(k(t.user.status==="1"?"启用":"禁用"),1)]),_:1},8,["type"])]),_:1}),e(o,{label:"是否启用"},{default:a(()=>[e(p,{bordered:!1,type:t.user.enable==="1"?"success":"error"},{default:a(()=>[$(k(t.user.enable==="1"?"是":"否"),1)]),_:1},8,["type"])]),_:1}),e(o,{label:"是否主管"},{default:a(()=>[e(p,{bordered:!1,type:t.user.isleader==="1"?"success":"default"},{default:a(()=>[$(k(t.user.isleader==="1"?"是":"否"),1)]),_:1},8,["type"])]),_:1}),e(o,{label:"是否团队长"},{default:a(()=>[e(p,{bordered:!1,type:t.user.isTeam==="1"?"success":"default"},{default:a(()=>[$(k(t.user.isTeam==="1"?"是":"否"),1)]),_:1},8,["type"])]),_:1}),t.user.extattr?(O(),L(o,{key:1,label:"扩展",span:2},{default:a(()=>[j("div",Lt,k(t.user.extattr),1)]),_:1})):H("",!0),c.value&&c.value.roles?(O(),L(o,{key:2,label:"角色",span:2},{default:a(()=>[j("div",jt,[(O(!0),A(le,null,me(c.value.roles,D=>(O(),L(p,{key:D.id},{default:a(()=>[$(k(D.name),1)]),_:2},1024))),128)),!c.value.roles||c.value.roles.length===0?(O(),L(p,{key:0},{default:a(()=>r[0]||(r[0]=[$("暂无角色")])),_:1})):H("",!0)])]),_:1})):H("",!0),c.value?(O(),L(o,{key:3,label:"备注",span:2},{default:a(()=>[j("div",Ft,k(c.value.remark||"暂无备注"),1)]),_:1})):H("",!0)]),_:1})]),_:1},8,["show"])]),_:1})):(O(),A("div",Bt,[e(C,{status:"warning",title:"OOPS",description:"请先选择对应用户"},{icon:a(()=>[e(v,{class:"text-6xl"})]),footer:a(()=>[e(u,null,{default:a(()=>r[1]||(r[1]=[$("Task Easy")])),_:1})]),_:1})]))}}},Ht=Y(At,[["__scopeId","data-v-17b50223"]]),Vt={__name:"form",props:{selectedUser:Object},emits:["update-user"],setup(t,{emit:f}){const c=t,b=f,m=w(null),r=w(!1),l=w({User_ID:"",username:"",Ding_ID:"",openid:"",department:"",main_department:"",position:"",mobile:"",gender:"",email:"",avatar:"",status:"1",enable:!0,isleader:!1,isTeam:!1,extattr:""}),p=w([]),o=[{label:"男",value:"1"},{label:"女",value:"2"},{label:"未知",value:"0"}],S=async()=>{try{const{data:h}=await q.get("/department/list"),{status:s,res:v}=h.value;s===200&&v&&(p.value=v.map(u=>({label:u.name,value:u.name})))}catch{p.value=[]}},I={User_ID:{required:!0,message:"请输入账号",trigger:["blur","input"]},username:{required:!0,message:"请输入用户姓名",trigger:["blur","input"]},mobile:{required:!0,message:"请输入手机号",trigger:["blur","input"]},email:{required:!0,message:"请输入邮箱",trigger:["blur","input"]},department:{required:!0,message:"请选择部门",trigger:["change"]},status:{required:!0,message:"请选择状态",trigger:["change"]}};X(()=>c.selectedUser,h=>{h?l.value={...h}:l.value={User_ID:"",username:"",Ding_ID:"",openid:"",department:"",main_department:"",position:"",mobile:"",gender:"",email:"",avatar:"",status:"1",enable:!0,isleader:!1,isTeam:!1,extattr:""}},{immediate:!0});const _=h=>{var s;h.preventDefault(),(s=m.value)==null||s.validate(v=>{if(!v){r.value=!0;try{b("update-user",l.value)}catch{}finally{setTimeout(()=>{r.value=!1},500)}}})};return Q(()=>{S()}),(h,s)=>{const v=fe,u=ve,C=st,D=it,n=Z,d=ge,z=ot,g=oe;return O(),L(g,{class:"user-form"},{default:a(()=>[e(z,{class:"user-form-scrollbar"},{default:a(()=>[e(d,{ref_key:"formRef",ref:m,model:l.value,rules:I,"label-placement":"left","label-width":"100px","require-mark-placement":"right-hanging",class:"grid grid-cols-2 gap-4"},{default:a(()=>[e(u,{label:"账号",path:"User_ID"},{default:a(()=>[e(v,{value:l.value.User_ID,"onUpdate:value":s[0]||(s[0]=i=>l.value.User_ID=i),placeholder:"请输入账号",disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"用户姓名",path:"username"},{default:a(()=>[e(v,{value:l.value.username,"onUpdate:value":s[1]||(s[1]=i=>l.value.username=i),placeholder:"请输入用户姓名",disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"钉钉ID",path:"Ding_ID"},{default:a(()=>[e(v,{value:l.value.Ding_ID,"onUpdate:value":s[2]||(s[2]=i=>l.value.Ding_ID=i),placeholder:"请输入钉钉ID",disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"微信ID",path:"openid"},{default:a(()=>[e(v,{value:l.value.openid,"onUpdate:value":s[3]||(s[3]=i=>l.value.openid=i),placeholder:"请输入微信ID",disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"部门",path:"department"},{default:a(()=>[e(C,{value:l.value.department,"onUpdate:value":s[4]||(s[4]=i=>l.value.department=i),placeholder:"请选择部门",options:p.value,disabled:r.value},null,8,["value","options","disabled"])]),_:1}),e(u,{label:"主部门",path:"main_department"},{default:a(()=>[e(C,{value:l.value.main_department,"onUpdate:value":s[5]||(s[5]=i=>l.value.main_department=i),placeholder:"请选择主部门",options:p.value,disabled:r.value},null,8,["value","options","disabled"])]),_:1}),e(u,{label:"位置",path:"position"},{default:a(()=>[e(v,{value:l.value.position,"onUpdate:value":s[6]||(s[6]=i=>l.value.position=i),placeholder:"请输入位置",disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"手机",path:"mobile"},{default:a(()=>[e(v,{value:l.value.mobile,"onUpdate:value":s[7]||(s[7]=i=>l.value.mobile=i),placeholder:"请输入手机号",disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"性别",path:"gender"},{default:a(()=>[e(C,{value:l.value.gender,"onUpdate:value":s[8]||(s[8]=i=>l.value.gender=i),placeholder:"请选择性别",options:o,disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"邮箱",path:"email"},{default:a(()=>[e(v,{value:l.value.email,"onUpdate:value":s[9]||(s[9]=i=>l.value.email=i),placeholder:"请输入邮箱",disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"头像",path:"avatar"},{default:a(()=>[e(v,{value:l.value.avatar,"onUpdate:value":s[10]||(s[10]=i=>l.value.avatar=i),placeholder:"请输入头像URL",disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"是否启用",path:"enable"},{default:a(()=>[e(D,{value:l.value.enable,"onUpdate:value":s[11]||(s[11]=i=>l.value.enable=i),disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"是否主管",path:"isleader"},{default:a(()=>[e(D,{value:l.value.isleader,"onUpdate:value":s[12]||(s[12]=i=>l.value.isleader=i),disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"是否团队长",path:"isTeam"},{default:a(()=>[e(D,{value:l.value.isTeam,"onUpdate:value":s[13]||(s[13]=i=>l.value.isTeam=i),disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{label:"扩展属性",path:"extattr",class:"col-span-2"},{default:a(()=>[e(v,{value:l.value.extattr,"onUpdate:value":s[14]||(s[14]=i=>l.value.extattr=i),type:"textarea",rows:4,placeholder:"请输入扩展属性",disabled:r.value},null,8,["value","disabled"])]),_:1}),e(u,{class:"form-item-bottom col-span-2"},{default:a(()=>[e(n,{type:"primary",onClick:_,loading:r.value,disabled:r.value},{default:a(()=>s[15]||(s[15]=[$("保存")])),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})}}},Nt=Y(Vt,[["__scopeId","data-v-a264fde3"]]),qt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Wt(t,f){return O(),A("svg",qt,f[0]||(f[0]=[j("path",{fill:"currentColor",d:"M12 14v2a6 6 0 0 0-6 6H4a8 8 0 0 1 8-8m0-1c-3.315 0-6-2.685-6-6s2.685-6 6-6s6 2.685 6 6s-2.685 6-6 6m0-2c2.21 0 4-1.79 4-4s-1.79-4-4-4s-4 1.79-4 4s1.79 4 4 4m8.828 10.071L18 24l-2.828-2.929c-1.562-1.618-1.562-4.24 0-5.858a3.904 3.904 0 0 1 5.656 0c1.563 1.618 1.563 4.24 0 5.858m-1.438-1.39c.813-.842.813-2.236 0-3.079a1.904 1.904 0 0 0-2.78 0c-.813.843-.813 2.237 0 3.08L18 21.12z"},null,-1)]))}const Gt={name:"ri-user-location-line",render:Wt},Kt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Jt(t,f){return O(),A("svg",Kt,f[0]||(f[0]=[j("path",{fill:"currentColor",d:"M21 4v2h-1l-5 7.5V22H9v-8.5L4 6H3V4zM6.404 6L11 12.894V20h2v-7.106L17.596 6z"},null,-1)]))}const Qt={name:"ri-filter-line",render:Jt},Xt={class:"component-context p-12"},Yt={class:"user-container h-full"},Zt={__name:"userManage",setup(t){w(null),w([]);const f=w("userDetail"),c=w(null),b=w({}),m=dt(),r=w(!1),l=w(null),p=w(!1),o=w(!1),S=w(null),I=w([{value:"userDetail",label:"用户详情"},{value:"orgInfoTree",label:"信息特权"},{value:"resourceTree",label:"资源特权"}]),_=()=>{p.value=!1,l.value={User_ID:"",username:"",Ding_ID:"",openid:"",department:"",main_department:"",position:"",mobile:"",gender:"",email:"",avatar:"",status:"1",enable:!0,isleader:!1,isTeam:!1,extattr:""},r.value=!0},h=n=>{c.value=n},s=n=>{c.value=n,p.value=!0,l.value={...n},l.value.enable=n.enable==="1",l.value.isleader=n.isleader==="1",l.value.isTeam=n.isTeam==="1",r.value=!0},v=async n=>{try{const{data:d}=await q.delete(`/user/${n.User_ID}`),{status:z}=d.value;if(z===200){m.success("删除用户成功");const g=document.querySelector(".user-datatable");g&&g.__vueParentComponent&&g.__vueParentComponent.ctx.fetchUsers(),c.value&&c.value.User_ID===n.User_ID&&(c.value=null)}else m.error("删除用户失败")}catch{m.error("删除用户出错")}},u=async n=>{try{o.value=!0;const d=p.value?`/user/${n.User_ID}`:"/user",z=p.value?"put":"post",g={...n,enable:n.enable?"1":"0",isleader:n.isleader?"1":"0",isTeam:n.isTeam?"1":"0"},{data:i}=await q[z](d,g),{status:T}=i.value;if(T===200){m.success(`${p.value?"更新":"添加"}用户成功`),r.value=!1;const y=document.querySelector(".user-datatable");if(y&&y.__vueParentComponent&&y.__vueParentComponent.ctx.fetchUsers(),p.value&&c.value){const{data:R}=await q.get(`/user/${n.User_ID}`);R.value.status===200&&(c.value=R.value.res)}}else m.error(`${p.value?"更新":"添加"}用户失败`)}catch{m.error(`${p.value?"更新":"添加"}用户出错`)}finally{o.value=!1}},C=w(0),D=new ResizeObserver(n=>{for(let d of n)C.value=parseInt(d.contentRect.height)});return Q(()=>{const n=document.querySelector(".user-card .n-card__content");D.observe(n)}),(n,d)=>{const z=Qt,g=fe,i=ve,T=Te,y=Z,R=ge,M=_e,V=Ot,F=oe,B=ut,ye=Ht,xe=Xe,ze=pt,we=Gt,Se=mt,Ce=ct,$e=Ne,Ie=ft,Ue=rt,De=Nt,ke=bt;return O(),A("div",Xt,[e(Ie,{class:"flow-content h-full","native-scrollbar":!1},{default:a(()=>[j("div",Yt,[e($e,{class:"h-full"},{default:a(()=>[e(F,{title:"人员管理",class:"user-management"},{default:a(()=>[e(Ce,{cols:24,"x-gap":12,class:"user-management-grid relative"},{default:a(()=>[e(B,{span:16,class:"user-management-column relative"},{default:a(()=>[e(F,{class:"user-card"},{header:a(()=>[e(M,{justify:"space-between",class:"form-header"},{default:a(()=>[e(M,{justify:"start"},{default:a(()=>[e(R,{ref:"formRef",inline:"","label-width":80,model:b.value,size:"small"},{default:a(()=>[e(i,{label:"姓名",path:"filterForm.name"},{default:a(()=>[e(g,{value:b.value.name,"onUpdate:value":d[0]||(d[0]=P=>b.value.name=P),placeholder:"输入姓名"},{prefix:a(()=>[e(z)]),_:1},8,["value"])]),_:1}),e(i,{label:"电话号码",path:"filterForm.phone"},{default:a(()=>[e(g,{value:b.value.phone,"onUpdate:value":d[1]||(d[1]=P=>b.value.phone=P),placeholder:"电话号码"},{prefix:a(()=>[e(z)]),_:1},8,["value"])]),_:1}),e(i,null,{default:a(()=>[e(y,null,{default:a(()=>[e(T)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(M,{justify:"end"},{default:a(()=>[e(y,{onClick:_},{default:a(()=>d[4]||(d[4]=[$("新增")])),_:1})]),_:1})]),_:1})]),default:a(()=>[e(V,{maxHeight:C.value,onEditUser:s,onDelete:v,onGetUser:h},null,8,["maxHeight"])]),_:1})]),_:1}),e(B,{span:8,class:"user-management-column relative"},{default:a(()=>[e(F,{class:"userInfo-card"},{default:a(()=>[e(Se,{value:f.value,"onUpdate:value":d[2]||(d[2]=P=>f.value=P),type:"card","tab-style":"min-width: 80px;",class:"user-tabs"},{prefix:a(()=>[e(we)]),suffix:a(()=>d[5]||(d[5]=[$("关于")])),default:a(()=>[(O(!0),A(le,null,me(I.value,P=>(O(),L(ze,{key:P.value,name:P.value,tab:P.label,class:"roleInfo-tab-panel"},{default:a(()=>[P.value=="userDetail"?(O(),L(ye,{key:0,user:c.value},null,8,["user"])):H("",!0),P.value=="resourceTree"?(O(),L(xe,{key:1,rangeCheckable:!0})):H("",!0)]),_:2},1032,["name","tab"]))),128))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),e(Ue,{loading:"加载中..."}),e(ke,{show:r.value,"onUpdate:show":d[3]||(d[3]=P=>r.value=P),preset:"card",title:"用户信息",style:{width:"50%"},"mask-closable":!o.value,closable:!o.value},{default:a(()=>[e(De,{selectedUser:l.value,onUpdateUser:u,ref_key:"userFormRef",ref:S},null,8,["selectedUser"])]),_:1},8,["show","mask-closable","closable"])])}}},kn=Y(Zt,[["__scopeId","data-v-ad0aa173"]]);export{kn as default};
