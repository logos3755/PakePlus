import{F as $,I as C,d as he,K as an,L as tt,r as A,c as E,o as pn,e as lt,g,J as B,bl as on,H as Q,G as ye,Q as qe,bm as it,R as L,b6 as we,bn as Ae,b7 as J,T as Rn,bo as Sn,bp as Nn,O as Cn,P as Be,U as ot,bq as en,b2 as Y,bh as at,br as rt,bs as gn,N as dt,bt as st,be as Ee,a6 as Me,b0 as Ve,M as ct,bu as nn,bv as bn}from"./entry.B79t8160.js";import{e as ut,a as ft,c as q,i as ht,h as He,j as vn,k as yn,l as gt}from"./Button.DLsEGMw6.js";import{u as $e,i as tn,b as pe,r as mn}from"./use-merged-state.Dyf7G0SV.js";import{_ as bt}from"./Checkbox.BnzM6f0E.js";import{N as kn,V as vt}from"./Empty.Dpu5cBr_.js";function yt(e){return typeof e=="string"?document.querySelector(e):typeof e=="function"?e():e}function Kn(e){return typeof e=="string"?`s-${e}`:`n-${e}`}function mt(e){return e instanceof HTMLElement?e.scrollTop:window.scrollY}function kt(e){return e instanceof HTMLElement?e.getBoundingClientRect():{top:0,bottom:window.innerHeight}}const xt=$("affix",[C("affixed",{position:"fixed"},[C("absolute-positioned",{position:"absolute"})])]),wt={listenTo:[String,Object,Function],top:Number,bottom:Number,triggerTop:Number,triggerBottom:Number,position:{type:String,default:"fixed"},offsetTop:{type:Number,validator:()=>!0,default:void 0},offsetBottom:{type:Number,validator:()=>!0,default:void 0},target:{type:Function,validator:()=>!0,default:void 0}},Mt=he({name:"Affix",props:wt,setup(e){const{mergedClsPrefixRef:t}=an(e);tt("-affix",xt,t);let s=null;const u=A(!1),r=A(!1),d=A(null),v=A(null),m=E(()=>r.value||u.value),k=E(()=>{var a,o;return(o=(a=e.triggerTop)!==null&&a!==void 0?a:e.offsetTop)!==null&&o!==void 0?o:e.top}),x=E(()=>{var a,o;return(o=(a=e.top)!==null&&a!==void 0?a:e.triggerTop)!==null&&o!==void 0?o:e.offsetTop}),y=E(()=>{var a,o;return(o=(a=e.bottom)!==null&&a!==void 0?a:e.triggerBottom)!==null&&o!==void 0?o:e.offsetBottom}),K=E(()=>{var a,o;return(o=(a=e.triggerBottom)!==null&&a!==void 0?a:e.offsetBottom)!==null&&o!==void 0?o:e.bottom}),b=A(null),p=()=>{const{target:a,listenTo:o}=e;a?s=a():o?s=yt(o):s=document,s&&(s.addEventListener("scroll",w),w())};function w(){ut(R)}function R(){const{value:a}=b;if(!s||!a)return;const o=mt(s);if(m.value){v.value!==null&&o<v.value&&(u.value=!1,v.value=null),d.value!==null&&o>d.value&&(r.value=!1,d.value=null);return}const T=kt(s),D=a.getBoundingClientRect(),z=D.top-T.top,W=T.bottom-D.bottom,M=k.value,V=K.value;M!==void 0&&z<=M?(u.value=!0,v.value=o-(M-z)):(u.value=!1,v.value=null),V!==void 0&&W<=V?(r.value=!0,d.value=o+V-W):(r.value=!1,d.value=null)}return pn(()=>{p()}),lt(()=>{s&&s.removeEventListener("scroll",w)}),{selfRef:b,affixed:m,mergedClsPrefix:t,mergedstyle:E(()=>{const a={};return u.value&&k.value!==void 0&&x.value!==void 0&&(a.top=`${x.value}px`),r.value&&K.value!==void 0&&y.value!==void 0&&(a.bottom=`${y.value}px`),a})}},render(){const{mergedClsPrefix:e}=this;return g("div",{ref:"selfRef",class:[`${e}-affix`,{[`${e}-affix--affixed`]:this.affixed,[`${e}-affix--absolute-positioned`]:this.position==="absolute"}],style:this.mergedstyle},this.$slots)}}),pt=he({name:"Switcher",render(){return g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},g("path",{d:"M12 8l10 8l-10 8z"}))}}),Rt=$("switch",`
 height: var(--n-height);
 min-width: var(--n-width);
 vertical-align: middle;
 user-select: none;
 -webkit-user-select: none;
 display: inline-flex;
 outline: none;
 justify-content: center;
 align-items: center;
`,[B("children-placeholder",`
 height: var(--n-rail-height);
 display: flex;
 flex-direction: column;
 overflow: hidden;
 pointer-events: none;
 visibility: hidden;
 `),B("rail-placeholder",`
 display: flex;
 flex-wrap: none;
 `),B("button-placeholder",`
 width: calc(1.75 * var(--n-rail-height));
 height: var(--n-rail-height);
 `),$("base-loading",`
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translateX(-50%) translateY(-50%);
 font-size: calc(var(--n-button-width) - 4px);
 color: var(--n-loading-color);
 transition: color .3s var(--n-bezier);
 `,[on({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})]),B("checked, unchecked",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 box-sizing: border-box;
 position: absolute;
 white-space: nowrap;
 top: 0;
 bottom: 0;
 display: flex;
 align-items: center;
 line-height: 1;
 `),B("checked",`
 right: 0;
 padding-right: calc(1.25 * var(--n-rail-height) - var(--n-offset));
 `),B("unchecked",`
 left: 0;
 justify-content: flex-end;
 padding-left: calc(1.25 * var(--n-rail-height) - var(--n-offset));
 `),Q("&:focus",[B("rail",`
 box-shadow: var(--n-box-shadow-focus);
 `)]),C("round",[B("rail","border-radius: calc(var(--n-rail-height) / 2);",[B("button","border-radius: calc(var(--n-button-height) / 2);")])]),ye("disabled",[ye("icon",[C("rubber-band",[C("pressed",[B("rail",[B("button","max-width: var(--n-button-width-pressed);")])]),B("rail",[Q("&:active",[B("button","max-width: var(--n-button-width-pressed);")])]),C("active",[C("pressed",[B("rail",[B("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])]),B("rail",[Q("&:active",[B("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])])])])])]),C("active",[B("rail",[B("button","left: calc(100% - var(--n-button-width) - var(--n-offset))")])]),B("rail",`
 overflow: hidden;
 height: var(--n-rail-height);
 min-width: var(--n-rail-width);
 border-radius: var(--n-rail-border-radius);
 cursor: pointer;
 position: relative;
 transition:
 opacity .3s var(--n-bezier),
 background .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 background-color: var(--n-rail-color);
 `,[B("button-icon",`
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 font-size: calc(var(--n-button-height) - 4px);
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 display: flex;
 justify-content: center;
 align-items: center;
 line-height: 1;
 `,[on()]),B("button",`
 align-items: center; 
 top: var(--n-offset);
 left: var(--n-offset);
 height: var(--n-button-height);
 width: var(--n-button-width-pressed);
 max-width: var(--n-button-width);
 border-radius: var(--n-button-border-radius);
 background-color: var(--n-button-color);
 box-shadow: var(--n-button-box-shadow);
 box-sizing: border-box;
 cursor: inherit;
 content: "";
 position: absolute;
 transition:
 background-color .3s var(--n-bezier),
 left .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 max-width .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 `)]),C("active",[B("rail","background-color: var(--n-rail-color-active);")]),C("loading",[B("rail",`
 cursor: wait;
 `)]),C("disabled",[B("rail",`
 cursor: not-allowed;
 opacity: .5;
 `)])]),St=Object.assign(Object.assign({},qe.props),{size:{type:String,default:"medium"},value:{type:[String,Number,Boolean],default:void 0},loading:Boolean,defaultValue:{type:[String,Number,Boolean],default:!1},disabled:{type:Boolean,default:void 0},round:{type:Boolean,default:!0},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],checkedValue:{type:[String,Number,Boolean],default:!0},uncheckedValue:{type:[String,Number,Boolean],default:!1},railStyle:Function,rubberBand:{type:Boolean,default:!0},onChange:[Function,Array]});let _e;const Vt=he({name:"Switch",props:St,setup(e){_e===void 0&&(typeof CSS<"u"?typeof CSS.supports<"u"?_e=CSS.supports("width","max(1px)"):_e=!1:_e=!0);const{mergedClsPrefixRef:t,inlineThemeDisabled:s}=an(e),u=qe("Switch","-switch",Rt,it,e,t),r=ft(e),{mergedSizeRef:d,mergedDisabledRef:v}=r,m=A(e.defaultValue),k=L(e,"value"),x=$e(k,m),y=E(()=>x.value===e.checkedValue),K=A(!1),b=A(!1),p=E(()=>{const{railStyle:S}=e;if(S)return S({focused:b.value,checked:y.value})});function w(S){const{"onUpdate:value":re,onChange:ne,onUpdateValue:de}=e,{nTriggerFormInput:ue,nTriggerFormChange:me}=r;re&&q(re,S),de&&q(de,S),ne&&q(ne,S),m.value=S,ue(),me()}function R(){const{nTriggerFormFocus:S}=r;S()}function a(){const{nTriggerFormBlur:S}=r;S()}function o(){e.loading||v.value||(x.value!==e.checkedValue?w(e.checkedValue):w(e.uncheckedValue))}function T(){b.value=!0,R()}function D(){b.value=!1,a(),K.value=!1}function z(S){e.loading||v.value||S.key===" "&&(x.value!==e.checkedValue?w(e.checkedValue):w(e.uncheckedValue),K.value=!1)}function W(S){e.loading||v.value||S.key===" "&&(S.preventDefault(),K.value=!0)}const M=E(()=>{const{value:S}=d,{self:{opacityDisabled:re,railColor:ne,railColorActive:de,buttonBoxShadow:ue,buttonColor:me,boxShadowFocus:G,loadingColor:te,textColor:se,iconColor:Fe,[we("buttonHeight",S)]:U,[we("buttonWidth",S)]:ce,[we("buttonWidthPressed",S)]:ke,[we("railHeight",S)]:le,[we("railWidth",S)]:fe,[we("railBorderRadius",S)]:c,[we("buttonBorderRadius",S)]:N},common:{cubicBezierEaseInOut:_}}=u.value;let O,j,ge;return _e?(O=`calc((${le} - ${U}) / 2)`,j=`max(${le}, ${U})`,ge=`max(${fe}, calc(${fe} + ${U} - ${le}))`):(O=Ae((J(le)-J(U))/2),j=Ae(Math.max(J(le),J(U))),ge=J(le)>J(U)?fe:Ae(J(fe)+J(U)-J(le))),{"--n-bezier":_,"--n-button-border-radius":N,"--n-button-box-shadow":ue,"--n-button-color":me,"--n-button-width":ce,"--n-button-width-pressed":ke,"--n-button-height":U,"--n-height":j,"--n-offset":O,"--n-opacity-disabled":re,"--n-rail-border-radius":c,"--n-rail-color":ne,"--n-rail-color-active":de,"--n-rail-height":le,"--n-rail-width":fe,"--n-width":ge,"--n-box-shadow-focus":G,"--n-loading-color":te,"--n-text-color":se,"--n-icon-color":Fe}}),V=s?Rn("switch",E(()=>d.value[0]),M,e):void 0;return{handleClick:o,handleBlur:D,handleFocus:T,handleKeyup:z,handleKeydown:W,mergedRailStyle:p,pressed:K,mergedClsPrefix:t,mergedValue:x,checked:y,mergedDisabled:v,cssVars:s?void 0:M,themeClass:V==null?void 0:V.themeClass,onRender:V==null?void 0:V.onRender}},render(){const{mergedClsPrefix:e,mergedDisabled:t,checked:s,mergedRailStyle:u,onRender:r,$slots:d}=this;r==null||r();const{checked:v,unchecked:m,icon:k,"checked-icon":x,"unchecked-icon":y}=d,K=!(tn(k)&&tn(x)&&tn(y));return g("div",{role:"switch","aria-checked":s,class:[`${e}-switch`,this.themeClass,K&&`${e}-switch--icon`,s&&`${e}-switch--active`,t&&`${e}-switch--disabled`,this.round&&`${e}-switch--round`,this.loading&&`${e}-switch--loading`,this.pressed&&`${e}-switch--pressed`,this.rubberBand&&`${e}-switch--rubber-band`],tabindex:this.mergedDisabled?void 0:0,style:this.cssVars,onClick:this.handleClick,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyup:this.handleKeyup,onKeydown:this.handleKeydown},g("div",{class:`${e}-switch__rail`,"aria-hidden":"true",style:u},pe(v,b=>pe(m,p=>b||p?g("div",{"aria-hidden":!0,class:`${e}-switch__children-placeholder`},g("div",{class:`${e}-switch__rail-placeholder`},g("div",{class:`${e}-switch__button-placeholder`}),b),g("div",{class:`${e}-switch__rail-placeholder`},g("div",{class:`${e}-switch__button-placeholder`}),p)):null)),g("div",{class:`${e}-switch__button`},pe(k,b=>pe(x,p=>pe(y,w=>g(Sn,null,{default:()=>this.loading?g(Nn,{key:"loading",clsPrefix:e,strokeWidth:20}):this.checked&&(p||b)?g("div",{class:`${e}-switch__button-icon`,key:p?"checked-icon":"icon"},p||b):!this.checked&&(w||b)?g("div",{class:`${e}-switch__button-icon`,key:w?"unchecked-icon":"icon"},w||b):null})))),pe(v,b=>b&&g("div",{key:"checked",class:`${e}-switch__checked`},b)),pe(m,b=>b&&g("div",{key:"unchecked",class:`${e}-switch__unchecked`},b)))))}}),Tn=Cn("n-tree-select"),Oe=Cn("n-tree"),Nt=he({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:t}=Be(Oe,null);return()=>{const{clsPrefix:s,expanded:u,hide:r,indent:d,onClick:v}=e;return g("span",{"data-switcher":!0,class:[`${s}-tree-node-switcher`,u&&`${s}-tree-node-switcher--expanded`,r&&`${s}-tree-node-switcher--hide`],style:{width:`${d}px`},onClick:v},g("div",{class:`${s}-tree-node-switcher__icon`},g(Sn,null,{default:()=>{if(e.loading)return g(Nn,{clsPrefix:s,key:"loading",radius:85,strokeWidth:20});const{value:m}=t;return m?m({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):g(ot,{clsPrefix:s,key:"switcher"},{default:()=>g(pt,null)})}})))}}}),Ct=he({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const t=Be(Oe);function s(r){const{onCheck:d}=e;d&&d(r)}function u(r){s(r)}return{handleUpdateValue:u,mergedTheme:t.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:t,checked:s,indeterminate:u,disabled:r,focusable:d,indent:v,handleUpdateValue:m}=this;return g("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${v}px`},"data-checkbox":!0},g(bt,{focusable:d,disabled:r,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:s,indeterminate:u,onUpdateChecked:m}))}}),Kt=he({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:s,renderSuffixRef:u,labelFieldRef:r}=Be(Oe),d=A(null);function v(k){const{onClick:x}=e;x&&x(k)}function m(k){v(k)}return{selfRef:d,renderLabel:t,renderPrefix:s,renderSuffix:u,labelField:r,handleClick:m}},render(){const{clsPrefix:e,labelField:t,nodeProps:s,checked:u=!1,selected:r=!1,renderLabel:d,renderPrefix:v,renderSuffix:m,handleClick:k,onDragstart:x,tmNode:{rawNode:y,rawNode:{prefix:K,suffix:b,[t]:p}}}=this;return g("span",Object.assign({},s,{ref:"selfRef",class:[`${e}-tree-node-content`,s==null?void 0:s.class],onClick:k,draggable:x===void 0?void 0:!0,onDragstart:x}),v||K?g("div",{class:`${e}-tree-node-content__prefix`},v?v({option:y,selected:r,checked:u}):en(K)):null,g("div",{class:`${e}-tree-node-content__text`},d?d({option:y,selected:r,checked:u}):en(p)),m||b?g("div",{class:`${e}-tree-node-content__suffix`},m?m({option:y,selected:r,checked:u}):en(b)):null)}});function xn({position:e,offsetLevel:t,indent:s,el:u}){const r={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")r.left=0,r.top=0,r.bottom=0,r.borderRadius="inherit",r.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const d=e==="before"?"top":"bottom";r[d]=0,r.left=`${u.offsetLeft+6-t*s}px`,r.height="2px",r.backgroundColor="var(--n-drop-mark-color)",r.transformOrigin=d,r.borderRadius="1px",r.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return g("div",{style:r})}function Tt({dropPosition:e,node:t}){return t.isLeaf===!1||t.children?!0:e!=="inside"}function Dt(e){return E(()=>e.leafOnly?"child":e.checkStrategy)}function ve(e,t){return!!e.rawNode[t]}function Dn(e,t,s,u){e==null||e.forEach(r=>{s(r),Dn(r[t],t,s,u),u(r)})}function Bt(e,t,s,u,r){const d=new Set,v=new Set,m=[];return Dn(e,u,k=>{if(m.push(k),r(t,k)){v.add(k[s]);for(let x=m.length-2;x>=0;--x)if(!d.has(m[x][s]))d.add(m[x][s]);else return}},()=>{m.pop()}),{expandedKeys:Array.from(d),highlightKeySet:v}}if(ht&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function Ft(e,t,s,u,r){const d=new Set,v=new Set,m=new Set,k=[],x=[],y=[];function K(p){p.forEach(w=>{if(y.push(w),t(s,w)){d.add(w[u]),m.add(w[u]);for(let a=y.length-2;a>=0;--a){const o=y[a][u];if(!v.has(o))v.add(o),d.has(o)&&d.delete(o);else break}}const R=w[r];R&&K(R),y.pop()})}K(e);function b(p,w){p.forEach(R=>{const a=R[u],o=d.has(a),T=v.has(a);if(!o&&!T)return;const D=R[r];if(D)if(o)w.push(R);else{k.push(a);const z=Object.assign(Object.assign({},R),{[r]:[]});w.push(z),b(D,z[r])}else w.push(R)})}return b(e,x),{filteredTree:x,highlightKeySet:m,expandedKeys:k}}const Bn=he({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=Be(Oe),{droppingNodeParentRef:s,droppingMouseNodeRef:u,draggingNodeRef:r,droppingPositionRef:d,droppingOffsetLevelRef:v,nodePropsRef:m,indentRef:k,blockLineRef:x,checkboxPlacementRef:y,checkOnClickRef:K,disabledFieldRef:b,showLineRef:p,renderSwitcherIconRef:w,overrideDefaultNodeClickBehaviorRef:R}=t,a=Y(()=>!!e.tmNode.rawNode.checkboxDisabled),o=Y(()=>ve(e.tmNode,b.value)),T=Y(()=>t.disabledRef.value||o.value),D=E(()=>{const{value:c}=m;if(c)return c({option:e.tmNode.rawNode})}),z=A(null),W={value:null};pn(()=>{W.value=z.value.$el});function M(){const c=()=>{const{tmNode:N}=e;if(!N.isLeaf&&!N.shallowLoaded){if(!t.loadingKeysRef.value.has(N.key))t.loadingKeysRef.value.add(N.key);else return;const{onLoadRef:{value:_}}=t;_&&_(N.rawNode).then(O=>{O!==!1&&t.handleSwitcherClick(N)}).finally(()=>{t.loadingKeysRef.value.delete(N.key)})}else t.handleSwitcherClick(N)};w.value?setTimeout(c,0):c()}const V=Y(()=>!o.value&&t.selectableRef.value&&(t.internalTreeSelect?t.mergedCheckStrategyRef.value!=="child"||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf:!0)),S=Y(()=>t.checkableRef.value&&(t.cascadeRef.value||t.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),re=Y(()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key)),ne=Y(()=>{const{value:c}=S;if(!c)return!1;const{value:N}=K,{tmNode:_}=e;return typeof N=="boolean"?!_.disabled&&N:N(e.tmNode.rawNode)});function de(c){const{value:N}=t.expandOnClickRef,{value:_}=V,{value:O}=ne;if(!_&&!N&&!O||He(c,"checkbox")||He(c,"switcher"))return;const{tmNode:j}=e;_&&t.handleSelect(j),N&&!j.isLeaf&&M(),O&&te(!re.value)}function ue(c){var N,_;if(!(He(c,"checkbox")||He(c,"switcher"))){if(!T.value){const O=R.value;let j=!1;if(O)switch(O({option:e.tmNode.rawNode})){case"toggleCheck":j=!0,te(!re.value);break;case"toggleSelect":j=!0,t.handleSelect(e.tmNode);break;case"toggleExpand":j=!0,M(),j=!0;break;case"none":j=!0,j=!0;return}j||de(c)}(_=(N=D.value)===null||N===void 0?void 0:N.onClick)===null||_===void 0||_.call(N,c)}}function me(c){x.value||ue(c)}function G(c){x.value&&ue(c)}function te(c){t.handleCheck(e.tmNode,c)}function se(c){t.handleDragStart({event:c,node:e.tmNode})}function Fe(c){c.currentTarget===c.target&&t.handleDragEnter({event:c,node:e.tmNode})}function U(c){c.preventDefault(),t.handleDragOver({event:c,node:e.tmNode})}function ce(c){t.handleDragEnd({event:c,node:e.tmNode})}function ke(c){c.currentTarget===c.target&&t.handleDragLeave({event:c,node:e.tmNode})}function le(c){c.preventDefault(),d.value!==null&&t.handleDrop({event:c,node:e.tmNode,dropPosition:d.value})}const fe=E(()=>{const{clsPrefix:c}=e,{value:N}=k;if(p.value){const _=[];let O=e.tmNode.parent;for(;O;)O.isLastChild?_.push(g("div",{class:`${c}-tree-node-indent`},g("div",{style:{width:`${N}px`}}))):_.push(g("div",{class:[`${c}-tree-node-indent`,`${c}-tree-node-indent--show-line`]},g("div",{style:{width:`${N}px`}}))),O=O.parent;return _.reverse()}else return at(e.tmNode.level,g("div",{class:`${e.clsPrefix}-tree-node-indent`},g("div",{style:{width:`${N}px`}})))});return{showDropMark:Y(()=>{const{value:c}=r;if(!c)return;const{value:N}=d;if(!N)return;const{value:_}=u;if(!_)return;const{tmNode:O}=e;return O.key===_.key}),showDropMarkAsParent:Y(()=>{const{value:c}=s;if(!c)return!1;const{tmNode:N}=e,{value:_}=d;return _==="before"||_==="after"?c.key===N.key:!1}),pending:Y(()=>t.pendingNodeKeyRef.value===e.tmNode.key),loading:Y(()=>t.loadingKeysRef.value.has(e.tmNode.key)),highlight:Y(()=>{var c;return(c=t.highlightKeySetRef.value)===null||c===void 0?void 0:c.has(e.tmNode.key)}),checked:re,indeterminate:Y(()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:Y(()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:Y(()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:T,checkable:S,mergedCheckOnClick:ne,checkboxDisabled:a,selectable:V,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:x,nodeProps:D,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:d,droppingOffsetLevel:v,indent:k,checkboxPlacement:y,showLine:p,contentInstRef:z,contentElRef:W,indentNodes:fe,handleCheck:te,handleDrop:le,handleDragStart:se,handleDragEnter:Fe,handleDragOver:U,handleDragEnd:ce,handleDragLeave:ke,handleLineClick:G,handleContentClick:me,handleSwitcherClick:M}},render(){const{tmNode:e,clsPrefix:t,checkable:s,expandOnClick:u,selectable:r,selected:d,checked:v,highlight:m,draggable:k,blockLine:x,indent:y,indentNodes:K,disabled:b,pending:p,internalScrollable:w,nodeProps:R,checkboxPlacement:a}=this,o=k&&!b?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,T=w?Kn(e.key):void 0,D=a==="right",z=s?g(Ct,{indent:y,right:D,focusable:this.checkboxFocusable,disabled:b||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return g("div",Object.assign({class:`${t}-tree-node-wrapper`},o),g("div",Object.assign({},x?R:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:d,[`${t}-tree-node--checkable`]:s,[`${t}-tree-node--highlight`]:m,[`${t}-tree-node--pending`]:p,[`${t}-tree-node--disabled`]:b,[`${t}-tree-node--selectable`]:r,[`${t}-tree-node--clickable`]:r||u||this.mergedCheckOnClick},R==null?void 0:R.class],"data-key":T,draggable:k&&x,onClick:this.handleLineClick,onDragstart:k&&x&&!b?this.handleDragStart:void 0}),K,e.isLeaf&&this.showLine?g("div",{class:[`${t}-tree-node-indent`,`${t}-tree-node-indent--show-line`,e.isLeaf&&`${t}-tree-node-indent--is-leaf`,e.isLastChild&&`${t}-tree-node-indent--last-child`]},g("div",{style:{width:`${y}px`}})):g(Nt,{clsPrefix:t,expanded:this.expanded,selected:d,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:y,onClick:this.handleSwitcherClick}),D?null:z,g(Kt,{ref:"contentInstRef",clsPrefix:t,checked:v,selected:d,onClick:this.handleContentClick,nodeProps:x?void 0:R,onDragstart:k&&!x&&!b?this.handleDragStart:void 0,tmNode:e}),k?this.showDropMark?xn({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:y}):this.showDropMarkAsParent?xn({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:y}):null:null,D?z:null))}});function Lt({props:e,fNodesRef:t,mergedExpandedKeysRef:s,mergedSelectedKeysRef:u,mergedCheckedKeysRef:r,handleCheck:d,handleSelect:v,handleSwitcherClick:m}){const{value:k}=u,x=Be(Tn,null),y=x?x.pendingNodeKeyRef:A(k.length?k[k.length-1]:null);function K(b){var p;if(!e.keyboard)return{enterBehavior:null};const{value:w}=y;let R=null;if(w===null){if((b.key==="ArrowDown"||b.key==="ArrowUp")&&b.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(b.key)&&w===null){const{value:a}=t;let o=0;for(;o<a.length;){if(!a[o].disabled){y.value=a[o].key;break}o+=1}}}else{const{value:a}=t;let o=a.findIndex(T=>T.key===w);if(!~o)return{enterBehavior:null};if(b.key==="Enter"){const T=a[o];switch(R=((p=e.overrideDefaultNodeClickBehavior)===null||p===void 0?void 0:p.call(e,{option:T.rawNode}))||null,R){case"toggleCheck":d(T,!r.value.includes(T.key));break;case"toggleSelect":v(T);break;case"toggleExpand":m(T);break;case"none":break;case"default":default:R="default",v(T)}}else if(b.key==="ArrowDown")for(b.preventDefault(),o+=1;o<a.length;){if(!a[o].disabled){y.value=a[o].key;break}o+=1}else if(b.key==="ArrowUp")for(b.preventDefault(),o-=1;o>=0;){if(!a[o].disabled){y.value=a[o].key;break}o-=1}else if(b.key==="ArrowLeft"){const T=a[o];if(T.isLeaf||!s.value.includes(w)){const D=T.getParent();D&&(y.value=D.key)}else m(T)}else if(b.key==="ArrowRight"){const T=a[o];if(T.isLeaf)return{enterBehavior:null};if(!s.value.includes(w))m(T);else for(o+=1;o<a.length;){if(!a[o].disabled){y.value=a[o].key;break}o+=1}}}return{enterBehavior:R}}return{pendingNodeKeyRef:y,handleKeydown:K}}const Pt=he({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return g(rt,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>g("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:Ae(this.height)}},this.nodes.map(t=>g(Bn,{clsPrefix:e,tmNode:t})))})}}),ln=on(),Et=$("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[Q("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),Q(">",[$("tree-node",[Q("&:first-child","margin-top: 0;")])]),$("tree-motion-wrapper",[C("expand",[gn({duration:"0.2s"})]),C("collapse",[gn({duration:"0.2s",reverse:!0})])]),$("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),$("tree-node",`
 transform: translate3d(0,0,0);
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[C("highlight",[$("tree-node-content",[B("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),C("disabled",[$("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),ye("disabled",[C("clickable",[$("tree-node-content",`
 cursor: pointer;
 `)])])]),C("block-node",[$("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),ye("block-line",[$("tree-node",[ye("disabled",[$("tree-node-content",[Q("&:hover","background: var(--n-node-color-hover);")]),C("selectable",[$("tree-node-content",[Q("&:active","background: var(--n-node-color-pressed);")])]),C("pending",[$("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),C("selected",[$("tree-node-content","background: var(--n-node-color-active);")])]),C("selected",[$("tree-node-content","background: var(--n-node-color-active);")])])]),C("block-line",[$("tree-node",[ye("disabled",[Q("&:hover","background: var(--n-node-color-hover);"),C("pending",`
 background: var(--n-node-color-hover);
 `),C("selectable",[ye("selected",[Q("&:active","background: var(--n-node-color-pressed);")])]),C("selected","background: var(--n-node-color-active);")]),C("selected","background: var(--n-node-color-active);"),C("disabled",`
 cursor: not-allowed;
 `)])]),$("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[C("show-line","position: relative",[Q("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-line-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),C("last-child",[Q("&::before",`
 bottom: 50%;
 `)]),C("is-leaf",[Q("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-line-color);
 `)])]),ye("show-line","height: 0;")]),$("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[B("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[$("icon",[ln]),$("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[ln]),$("base-icon",[ln])]),C("hide","visibility: hidden;"),C("expanded","transform: rotate(90deg);")]),$("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),$("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[Q("&:last-child","margin-bottom: 0;"),B("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),B("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),B("suffix",`
 display: inline-flex;
 `)]),B("empty","margin: auto;")]);var _t=function(e,t,s,u){function r(d){return d instanceof s?d:new s(function(v){v(d)})}return new(s||(s=Promise))(function(d,v){function m(y){try{x(u.next(y))}catch(K){v(K)}}function k(y){try{x(u.throw(y))}catch(K){v(K)}}function x(y){y.done?d(y.value):r(y.value).then(m,k)}x((u=u.apply(e,[])).next())})};function wn(e,t,s,u){return{getIsGroup(){return!1},getKey(d){return d[e]},getChildren:u||(d=>d[t]),getDisabled(d){return!!(d[s]||d.checkboxDisabled)}}}const $t={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array],overrideDefaultNodeClickBehavior:Function},At=Object.assign(Object.assign(Object.assign(Object.assign({},qe.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,indent:{type:Number,default:24},allowDrop:{type:Function,default:Tt},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),$t),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),Ht=he({name:"Tree",props:At,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:s,mergedRtlRef:u}=an(e),r=dt("Tree",u,t),d=qe("Tree","-tree",Et,st,e,t),v=A(null),m=A(null),k=A(null);function x(){var n;return(n=k.value)===null||n===void 0?void 0:n.listElRef}function y(){var n;return(n=k.value)===null||n===void 0?void 0:n.itemsElRef}const K=E(()=>{const{filter:n}=e;if(n)return n;const{labelField:l}=e;return(i,f)=>{if(!i.length)return!0;const h=f[l];return typeof h=="string"?h.toLowerCase().includes(i.toLowerCase()):!1}}),b=E(()=>{const{pattern:n}=e;return n?!n.length||!K.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:Ft(e.data,K.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),p=E(()=>vn(e.showIrrelevantNodes?e.data:b.value.filteredTree,wn(e.keyField,e.childrenField,e.disabledField,e.getChildren))),w=Be(Tn,null),R=e.internalTreeSelect?w.dataTreeMate:E(()=>e.showIrrelevantNodes?p.value:vn(e.data,wn(e.keyField,e.childrenField,e.disabledField,e.getChildren))),{watchProps:a}=e,o=A([]);a!=null&&a.includes("defaultCheckedKeys")?Ee(()=>{o.value=e.defaultCheckedKeys}):o.value=e.defaultCheckedKeys;const T=L(e,"checkedKeys"),D=$e(T,o),z=E(()=>R.value.getCheckedKeys(D.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),W=Dt(e),M=E(()=>z.value.checkedKeys),V=E(()=>{const{indeterminateKeys:n}=e;return n!==void 0?n:z.value.indeterminateKeys}),S=A([]);a!=null&&a.includes("defaultSelectedKeys")?Ee(()=>{S.value=e.defaultSelectedKeys}):S.value=e.defaultSelectedKeys;const re=L(e,"selectedKeys"),ne=$e(re,S),de=A([]),ue=n=>{de.value=e.defaultExpandAll?R.value.getNonLeafKeys():n===void 0?e.defaultExpandedKeys:n};a!=null&&a.includes("defaultExpandedKeys")?Ee(()=>{ue(void 0)}):Ee(()=>{ue(e.defaultExpandedKeys)});const me=L(e,"expandedKeys"),G=$e(me,de),te=E(()=>p.value.getFlattenedNodes(G.value)),{pendingNodeKeyRef:se,handleKeydown:Fe}=Lt({props:e,mergedCheckedKeysRef:D,mergedSelectedKeysRef:ne,fNodesRef:te,mergedExpandedKeysRef:G,handleCheck:Qe,handleSelect:Je,handleSwitcherClick:sn});let U=null,ce=null;const ke=A(new Set),le=E(()=>e.internalHighlightKeySet||b.value.highlightKeySet),fe=$e(le,ke),c=A(new Set),N=E(()=>G.value.filter(n=>!c.value.has(n)));let _=0;const O=A(null),j=A(null),ge=A(null),Ie=A(null),ze=A(0),Fn=E(()=>{const{value:n}=j;return n?n.parent:null});let We=!1;Me(L(e,"data"),()=>{We=!0,Ve(()=>{We=!1}),c.value.clear(),se.value=null,Pe()},{deep:!1});let Ye=!1;const Ge=()=>{Ye=!0,Ve(()=>{Ye=!1})};let Le;Me(L(e,"pattern"),(n,l)=>{if(e.showIrrelevantNodes)if(Le=void 0,n){const{expandedKeys:i,highlightKeySet:f}=Bt(e.data,e.pattern,e.keyField,e.childrenField,K.value);ke.value=f,Ge(),Se(i,Z(i),{node:null,action:"filter"})}else ke.value=new Set;else if(!n.length)Le!==void 0&&(Ge(),Se(Le,Z(Le),{node:null,action:"filter"}));else{l.length||(Le=G.value);const{expandedKeys:i}=b.value;i!==void 0&&(Ge(),Se(i,Z(i),{node:null,action:"filter"}))}});function rn(n){return _t(this,void 0,void 0,function*(){const{onLoad:l}=e;if(!l){yield Promise.resolve();return}const{value:i}=c;if(!i.has(n.key)){i.add(n.key);try{(yield l(n.rawNode))===!1&&Ne()}catch{Ne()}i.delete(n.key)}})}Ee(()=>{var n;const{value:l}=p;if(!l)return;const{getNode:i}=l;(n=G.value)===null||n===void 0||n.forEach(f=>{const h=i(f);h&&!h.shallowLoaded&&rn(h)})});const Re=A(!1),be=A([]);Me(N,(n,l)=>{if(!e.animated||Ye){Ve(Ue);return}if(We)return;const i=J(d.value.self.nodeHeight),f=new Set(l);let h=null,I=null;for(const P of n)if(!f.has(P)){if(h!==null)return;h=P}const X=new Set(n);for(const P of l)if(!X.has(P)){if(I!==null)return;I=P}if(h===null&&I===null)return;const{virtualScroll:ee}=e,Ke=(ee?k.value.listElRef:v.value).offsetHeight,Te=Math.ceil(Ke/i)+1;let ie;if(h!==null&&(ie=l),I!==null&&(ie===void 0?ie=n:ie=ie.filter(P=>P!==I)),Re.value=!0,be.value=p.value.getFlattenedNodes(ie),h!==null){const P=be.value.findIndex(oe=>oe.key===h);if(~P){const oe=be.value[P].children;if(oe){const ae=yn(oe,n);be.value.splice(P+1,0,{__motion:!0,mode:"expand",height:ee?ae.length*i:void 0,nodes:ee?ae.slice(0,Te):ae})}}}if(I!==null){const P=be.value.findIndex(oe=>oe.key===I);if(~P){const oe=be.value[P].children;if(!oe)return;Re.value=!0;const ae=yn(oe,n);be.value.splice(P+1,0,{__motion:!0,mode:"collapse",height:ee?ae.length*i:void 0,nodes:ee?ae.slice(0,Te):ae})}}});const Ln=E(()=>gt(te.value)),Pn=E(()=>Re.value?be.value:te.value);function Ue(){const{value:n}=m;n&&n.sync()}function En(){Re.value=!1,e.virtualScroll&&Ve(Ue)}function Z(n){const{getNode:l}=R.value;return n.map(i=>{var f;return((f=l(i))===null||f===void 0?void 0:f.rawNode)||null})}function Se(n,l,i){const{"onUpdate:expandedKeys":f,onUpdateExpandedKeys:h}=e;de.value=n,f&&q(f,n,l,i),h&&q(h,n,l,i)}function dn(n,l,i){const{"onUpdate:checkedKeys":f,onUpdateCheckedKeys:h}=e;o.value=n,h&&q(h,n,l,i),f&&q(f,n,l,i)}function _n(n,l){const{"onUpdate:indeterminateKeys":i,onUpdateIndeterminateKeys:f}=e;i&&q(i,n,l),f&&q(f,n,l)}function Xe(n,l,i){const{"onUpdate:selectedKeys":f,onUpdateSelectedKeys:h}=e;S.value=n,h&&q(h,n,l,i),f&&q(f,n,l,i)}function $n(n){const{onDragenter:l}=e;l&&q(l,n)}function An(n){const{onDragleave:l}=e;l&&q(l,n)}function On(n){const{onDragend:l}=e;l&&q(l,n)}function In(n){const{onDragstart:l}=e;l&&q(l,n)}function zn(n){const{onDragover:l}=e;l&&q(l,n)}function Un(n){const{onDrop:l}=e;l&&q(l,n)}function Pe(){jn(),xe()}function jn(){O.value=null}function xe(){ze.value=0,j.value=null,ge.value=null,Ie.value=null,Ne()}function Ne(){U&&(window.clearTimeout(U),U=null),ce=null}function Qe(n,l){if(e.disabled||ve(n,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){Je(n);return}const i=l?"check":"uncheck",{checkedKeys:f,indeterminateKeys:h}=R.value[i](n.key,M.value,{cascade:e.cascade,checkStrategy:W.value,allowNotLoaded:e.allowCheckingNotLoaded});dn(f,Z(f),{node:n.rawNode,action:i}),_n(h,Z(h))}function Mn(n){if(e.disabled)return;const{key:l}=n,{value:i}=G,f=i.findIndex(h=>h===l);if(~f){const h=Array.from(i);h.splice(f,1),Se(h,Z(h),{node:n.rawNode,action:"collapse"})}else{const h=p.value.getNode(l);if(!h||h.isLeaf)return;let I;if(e.accordion){const X=new Set(n.siblings.map(({key:ee})=>ee));I=i.filter(ee=>!X.has(ee)),I.push(l)}else I=i.concat(l);Se(I,Z(I),{node:n.rawNode,action:"expand"})}}function sn(n){e.disabled||Re.value||Mn(n)}function Je(n){if(!(e.disabled||!e.selectable)){if(se.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:l,indeterminateKeys:i}}=z;e.multiple?Qe(n,!(l.includes(n.key)||i.includes(n.key))):dn([n.key],Z([n.key]),{node:n.rawNode,action:"check"})}if(e.multiple){const l=Array.from(ne.value),i=l.findIndex(f=>f===n.key);~i?e.cancelable&&l.splice(i,1):~i||l.push(n.key),Xe(l,Z(l),{node:n.rawNode,action:~i?"unselect":"select"})}else ne.value.includes(n.key)?e.cancelable&&Xe([],[],{node:n.rawNode,action:"unselect"}):Xe([n.key],Z([n.key]),{node:n.rawNode,action:"select"})}}function Vn(n){if(U&&(window.clearTimeout(U),U=null),n.isLeaf)return;ce=n.key;const l=()=>{if(ce!==n.key)return;const{value:i}=ge;if(i&&i.key===n.key&&!G.value.includes(n.key)){const f=G.value.concat(n.key);Se(f,Z(f),{node:n.rawNode,action:"expand"})}U=null,ce=null};n.shallowLoaded?U=window.setTimeout(()=>{l()},1e3):U=window.setTimeout(()=>{rn(n).then(()=>{l()})},1e3)}function Hn({event:n,node:l}){!e.draggable||e.disabled||ve(l,e.disabledField)||(cn({event:n,node:l},!1),$n({event:n,node:l.rawNode}))}function qn({event:n,node:l}){!e.draggable||e.disabled||ve(l,e.disabledField)||An({event:n,node:l.rawNode})}function Wn(n){n.target===n.currentTarget&&xe()}function Yn({event:n,node:l}){Pe(),!(!e.draggable||e.disabled||ve(l,e.disabledField))&&On({event:n,node:l.rawNode})}function Gn({event:n,node:l}){!e.draggable||e.disabled||ve(l,e.disabledField)||(_=n.clientX,O.value=l,In({event:n,node:l.rawNode}))}function cn({event:n,node:l},i=!0){var f;if(!e.draggable||e.disabled||ve(l,e.disabledField))return;const{value:h}=O;if(!h)return;const{allowDrop:I,indent:X}=e;i&&zn({event:n,node:l.rawNode});const ee=n.currentTarget,{height:Ke,top:Te}=ee.getBoundingClientRect(),ie=n.clientY-Te;let P;I({node:l.rawNode,dropPosition:"inside",phase:"drag"})?ie<=8?P="before":ie>=Ke-8?P="after":P="inside":ie<=Ke/2?P="before":P="after";const{value:ae}=Ln;let F,H;const De=ae(l.key);if(De===null){xe();return}let je=!1;P==="inside"?(F=l,H="inside"):P==="before"?l.isFirstChild?(F=l,H="before"):(F=te.value[De-1],H="after"):(F=l,H="after"),!F.isLeaf&&G.value.includes(F.key)&&(je=!0,H==="after"&&(F=te.value[De+1],F?H="before":(F=l,H="inside")));const fn=F;if(ge.value=fn,!je&&h.isLastChild&&h.key===F.key&&(H="after"),H==="after"){let hn=_-n.clientX,Ze=0;for(;hn>=X/2&&F.parent!==null&&F.isLastChild&&Ze<1;)hn-=X,Ze+=1,F=F.parent;ze.value=Ze}else ze.value=0;if((h.contains(F)||H==="inside"&&((f=h.parent)===null||f===void 0?void 0:f.key)===F.key)&&!(h.key===fn.key&&h.key===F.key)){xe();return}if(!I({node:F.rawNode,dropPosition:H,phase:"drag"})){xe();return}if(h.key===F.key)Ne();else if(ce!==F.key)if(H==="inside"){if(e.expandOnDragenter){if(Vn(F),!F.shallowLoaded&&ce!==F.key){Pe();return}}else if(!F.shallowLoaded){Pe();return}}else Ne();else H!=="inside"&&Ne();Ie.value=H,j.value=F}function Xn({event:n,node:l,dropPosition:i}){if(!e.draggable||e.disabled||ve(l,e.disabledField))return;const{value:f}=O,{value:h}=j,{value:I}=Ie;if(!(!f||!h||!I)&&e.allowDrop({node:h.rawNode,dropPosition:I,phase:"drag"})&&f.key!==h.key){if(I==="before"){const X=f.getNext({includeDisabled:!0});if(X&&X.key===h.key){xe();return}}if(I==="after"){const X=f.getPrev({includeDisabled:!0});if(X&&X.key===h.key){xe();return}}Un({event:n,node:h.rawNode,dragNode:f.rawNode,dropPosition:i}),Pe()}}function Qn(){Ue()}function Jn(){Ue()}function Zn(n){var l;if(e.virtualScroll||e.internalScrollable){const{value:i}=m;if(!((l=i==null?void 0:i.containerRef)===null||l===void 0)&&l.contains(n.relatedTarget))return;se.value=null}else{const{value:i}=v;if(i!=null&&i.contains(n.relatedTarget))return;se.value=null}}Me(se,n=>{var l,i;if(n!==null){if(e.virtualScroll)(l=k.value)===null||l===void 0||l.scrollTo({key:n});else if(e.internalScrollable){const{value:f}=m;if(f===null)return;const h=(i=f.contentRef)===null||i===void 0?void 0:i.querySelector(`[data-key="${Kn(n)}"]`);if(!h)return;f.scrollTo({el:h})}}}),ct(Oe,{loadingKeysRef:c,highlightKeySetRef:fe,displayedCheckedKeysRef:M,displayedIndeterminateKeysRef:V,mergedSelectedKeysRef:ne,mergedExpandedKeysRef:G,mergedThemeRef:d,mergedCheckStrategyRef:W,nodePropsRef:L(e,"nodeProps"),disabledRef:L(e,"disabled"),checkableRef:L(e,"checkable"),selectableRef:L(e,"selectable"),expandOnClickRef:L(e,"expandOnClick"),onLoadRef:L(e,"onLoad"),draggableRef:L(e,"draggable"),blockLineRef:L(e,"blockLine"),indentRef:L(e,"indent"),cascadeRef:L(e,"cascade"),checkOnClickRef:L(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:ge,droppingNodeParentRef:Fn,draggingNodeRef:O,droppingPositionRef:Ie,droppingOffsetLevelRef:ze,fNodesRef:te,pendingNodeKeyRef:se,showLineRef:L(e,"showLine"),disabledFieldRef:L(e,"disabledField"),internalScrollableRef:L(e,"internalScrollable"),internalCheckboxFocusableRef:L(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:L(e,"renderLabel"),renderPrefixRef:L(e,"renderPrefix"),renderSuffixRef:L(e,"renderSuffix"),renderSwitcherIconRef:L(e,"renderSwitcherIcon"),labelFieldRef:L(e,"labelField"),multipleRef:L(e,"multiple"),overrideDefaultNodeClickBehaviorRef:L(e,"overrideDefaultNodeClickBehavior"),handleSwitcherClick:sn,handleDragEnd:Yn,handleDragEnter:Hn,handleDragLeave:qn,handleDragStart:Gn,handleDrop:Xn,handleDragOver:cn,handleSelect:Je,handleCheck:Qe});function et(n,l){var i,f;typeof n=="number"?(i=k.value)===null||i===void 0||i.scrollTo(n,l||0):(f=k.value)===null||f===void 0||f.scrollTo(n)}const nt={handleKeydown:Fe,scrollTo:et,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:n}=z.value;return{keys:n,options:Z(n)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:n}=z.value;return{keys:n,options:Z(n)}}},un=E(()=>{const{common:{cubicBezierEaseInOut:n},self:{fontSize:l,nodeBorderRadius:i,nodeColorHover:f,nodeColorPressed:h,nodeColorActive:I,arrowColor:X,loadingColor:ee,nodeTextColor:Ke,nodeTextColorDisabled:Te,dropMarkColor:ie,nodeWrapperPadding:P,nodeHeight:oe,lineHeight:ae,lineColor:F}}=d.value,H=nn(P,"top"),De=nn(P,"bottom"),je=Ae(J(oe)-J(H)-J(De));return{"--n-arrow-color":X,"--n-loading-color":ee,"--n-bezier":n,"--n-font-size":l,"--n-node-border-radius":i,"--n-node-color-active":I,"--n-node-color-hover":f,"--n-node-color-pressed":h,"--n-node-text-color":Ke,"--n-node-text-color-disabled":Te,"--n-drop-mark-color":ie,"--n-node-wrapper-padding":P,"--n-line-offset-top":`-${H}`,"--n-line-offset-bottom":`-${De}`,"--n-node-content-height":je,"--n-line-height":ae,"--n-line-color":F}}),Ce=s?Rn("tree",void 0,un,e):void 0;return Object.assign(Object.assign({},nt),{mergedClsPrefix:t,mergedTheme:d,rtlEnabled:r,fNodes:Pn,aip:Re,selfElRef:v,virtualListInstRef:k,scrollbarInstRef:m,handleFocusout:Zn,handleDragLeaveTree:Wn,handleScroll:Qn,getScrollContainer:x,getScrollContent:y,handleAfterEnter:En,handleResize:Jn,cssVars:s?void 0:un,themeClass:Ce==null?void 0:Ce.themeClass,onRender:Ce==null?void 0:Ce.onRender})},render(){var e;const{fNodes:t,internalRenderEmpty:s}=this;if(!t.length&&s)return s();const{mergedClsPrefix:u,blockNode:r,blockLine:d,draggable:v,disabled:m,internalFocusable:k,checkable:x,handleKeydown:y,rtlEnabled:K,handleFocusout:b,scrollbarProps:p}=this,w=k&&!m,R=w?"0":void 0,a=[`${u}-tree`,K&&`${u}-tree--rtl`,x&&`${u}-tree--checkable`,(d||r)&&`${u}-tree--block-node`,d&&`${u}-tree--block-line`],o=D=>"__motion"in D?g(Pt,{height:D.height,nodes:D.nodes,clsPrefix:u,mode:D.mode,onAfterEnter:this.handleAfterEnter}):g(Bn,{key:D.key,tmNode:D,clsPrefix:u});if(this.virtualScroll){const{mergedTheme:D,internalScrollablePadding:z}=this,W=nn(z||"0");return g(bn,Object.assign({},p,{ref:"scrollbarInstRef",onDragleave:v?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:a,theme:D.peers.Scrollbar,themeOverrides:D.peerOverrides.Scrollbar,tabindex:R,onKeydown:w?y:void 0,onFocusout:w?b:void 0}),{default:()=>{var M;return(M=this.onRender)===null||M===void 0||M.call(this),t.length?g(vt,{ref:"virtualListInstRef",items:this.fNodes,itemSize:J(D.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:W.top,paddingBottom:W.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:W.left,paddingRight:W.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:V})=>o(V)}):mn(this.$slots.empty,()=>[g(kn,{class:`${u}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})])}})}const{internalScrollable:T}=this;return a.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),T?g(bn,Object.assign({},p,{class:a,tabindex:R,onKeydown:w?y:void 0,onFocusout:w?b:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>g("div",{onDragleave:v?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(o))}):g("div",{class:a,tabindex:R,ref:"selfElRef",style:this.cssVars,onKeydown:w?y:void 0,onFocusout:w?b:void 0,onDragleave:v?this.handleDragLeaveTree:void 0},t.length?t.map(o):mn(this.$slots.empty,()=>[g(kn,{class:`${u}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}});export{Ht as N,Vt as _,Mt as a};
